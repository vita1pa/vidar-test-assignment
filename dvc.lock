schema: '2.0'
stages:
  decoding_xml_to_wav:
    cmd: python -m pipeline process-xml-files --input-folder data/xml_input 
      --output-folder data/processed/extracted_wav
    deps:
    - path: data/xml_input
      hash: md5
      md5: b828ec2eb129ebc78c083bdd20011005.dir
      size: 1994595350
      nfiles: 798
    - path: pipeline/decode_xml_to_wav.py
      hash: md5
      md5: a57e65487f90b28fbae91c8cd9f6240b
      size: 5246
    outs:
    - path: data/processed/extracted_wav
      hash: md5
      md5: 6f74e7fc9024c13a9a62be8f7e4c709c.dir
      size: 1495633892
      nfiles: 798
  downsampling_audio:
    cmd: python -m pipeline downsample-audio --input-folder 
      data/processed/extracted_wav --output-folder 
      data/processed/downsampled_wav
    deps:
    - path: data/processed/extracted_wav
      hash: md5
      md5: 6f74e7fc9024c13a9a62be8f7e4c709c.dir
      size: 1495633892
      nfiles: 798
    - path: pipeline/downsample_wav.py
      hash: md5
      md5: 98683e22caf2389c1d8302e55f218519
      size: 5468
    params:
      params.yaml:
        target_sr: 16000
    outs:
    - path: data/processed/downsampled_wav
      hash: md5
      md5: 4666349f9a47b9beb8c246412a5e6ba6.dir
      size: 271346322
      nfiles: 798
  filtering_outdoor:
    cmd: python -m pipeline highpass-filter --input-folder 
      data/processed/downsampled_wav --output-folder 
      data/processed/filtered_outdoor_wav
    deps:
    - path: data/processed/downsampled_wav
      hash: md5
      md5: 4666349f9a47b9beb8c246412a5e6ba6.dir
      size: 271346322
      nfiles: 798
    - path: pipeline/filter_outdoor.py
      hash: md5
      md5: 21baf18db866b1c0a1828513efa90adf
      size: 8616
    params:
      params.yaml:
        cutoff_freq: 20
        target_sr: 16000
    outs:
    - path: data/processed/filtered_outdoor_wav
      hash: md5
      md5: cc7cf83a5c0fa06954cce4858715545f.dir
      size: 271346322
      nfiles: 798
  extracting_sound_data:
    cmd: python -m pipeline analyze-wav-files --input-folder 
      data/processed/filtered_outdoor_wav --output-folder 
      data/processed/wav_sound_metadata
    deps:
    - path: data/processed/filtered_outdoor_wav
      hash: md5
      md5: cc7cf83a5c0fa06954cce4858715545f.dir
      size: 271346322
      nfiles: 798
    - path: pipeline/extract_sound_data_from_wav.py
      hash: md5
      md5: 0ffb5262d99bc3ce3507cc3039b86f1d
      size: 4524
    outs:
    - path: data/processed/wav_sound_metadata/wav_metadata.csv
      hash: md5
      md5: ccc38956aa1c0b2ce960b4729bd2d688
      size: 45908
  concatenating_segments:
    cmd: python -m pipeline concatenate-audio --input-folder 
      data/processed/filtered_outdoor_wav --output-folder 
      data/processed/concatenated_wav_segments --metadata-path 
      data/processed/wav_sound_metadata/wav_metadata.csv
    deps:
    - path: data/processed/filtered_outdoor_wav
      hash: md5
      md5: cc7cf83a5c0fa06954cce4858715545f.dir
      size: 271346322
      nfiles: 798
    - path: data/processed/wav_sound_metadata/wav_metadata.csv
      hash: md5
      md5: ccc38956aa1c0b2ce960b4729bd2d688
      size: 45908
    - path: pipeline/concatenate_into_segments.py
      hash: md5
      md5: e7579af23d03557511204ce8b558bfb1
      size: 7423
    params:
      params.yaml:
        concat_duration: 1800
        concat_tolerance: 180
    outs:
    - path: data/processed/concatenated_wav_segments
      hash: md5
      md5: 2826f8f7e1e6a4189605f65ebb22c1ca.dir
      size: 271311430
      nfiles: 5
  preparing_recording_positions:
    cmd: python -m pipeline generate-labels --input-folder 
      data/processed/concatenated_wav_segments --output-folder 
      labels/recording_positions --metadata-path 
      data/processed/wav_sound_metadata/wav_metadata.csv
    deps:
    - path: data/processed/concatenated_wav_segments
      hash: md5
      md5: 2826f8f7e1e6a4189605f65ebb22c1ca.dir
      size: 271311430
      nfiles: 5
    - path: data/processed/wav_sound_metadata/wav_metadata.csv
      hash: md5
      md5: ccc38956aa1c0b2ce960b4729bd2d688
      size: 45908
    - path: pipeline/prepare_recording_positions.py
      hash: md5
      md5: 12ba83998bbf08b9901ad7877c77027e
      size: 5241
    outs:
    - path: labels/recording_positions
      hash: md5
      md5: 57f105befe7ec3fff1a8e4f368b45f16.dir
      size: 37415
      nfiles: 5
  getting_speech_probabilities:
    cmd: python -m pipeline detect-speech --input-folder 
      data/processed/concatenated_wav_segments --output-folder 
      data/processed/speech_detection_probabilities
    deps:
    - path: data/processed/concatenated_wav_segments
      hash: md5
      md5: 2826f8f7e1e6a4189605f65ebb22c1ca.dir
      size: 271311430
      nfiles: 5
    - path: pipeline/get_speech_probabilities.py
      hash: md5
      md5: daac55a082764bc2d380e88dd162113f
      size: 5807
    outs:
    - path: data/processed/speech_detection_probabilities
      hash: md5
      md5: 178d12c94df50ff3f13ba8c3813830d9.dir
      size: 9696984
      nfiles: 5
  preparing_speech_labels:
    cmd: python -m pipeline label-speech --input-folder 
      data/processed/speech_detection_probabilities --output-folder 
      labels/speech_detection
    deps:
    - path: data/processed/speech_detection_probabilities
      hash: md5
      md5: 178d12c94df50ff3f13ba8c3813830d9.dir
      size: 9696984
      nfiles: 5
    - path: pipeline/prepare_speech_labels.py
      hash: md5
      md5: 73923a2a0bffa318878cd4d84d5b76fd
      size: 6231
    params:
      params.yaml:
        frame_step: 0.01
        prob_threshold: 0.5
    outs:
    - path: labels/speech_detection
      hash: md5
      md5: 4b6a545b94162424bfdbb218c2da5357.dir
      size: 1682
      nfiles: 5
  initializating_mlflow:
    cmd: python pipeline/utils/mlflow_tracking.py
    outs:
    - path: parent_run_id.json
      hash: md5
      md5: 913285f9d24623ed3ef60ba48907dac7
      size: 53
